\usepackage[utf8]{inputenc}
\usepackage{listings}

\title{Introducing Middlefield -- Custom generic developer tool}
\subtitle{https://github.com/elcaminoreal/ https://github.com/moshez/introducing-middlefield -- reinventing plugins (gather), cli parsing (caparg) and dependency injection (elcaminoreal)}
\author{Moshe Zadka -- https://cobordism.com}
\date{Pyninsula January 2017}
 
\begin{document}
 
\frame{\titlepage}

\begin{frame}[fragile]
\frametitle{Build Pex with plugins to add commands}
\begin{lstlisting}
$ pip install middlefield
$ mf echo --what hello
Usage:
    self-build
$ mf self-build --output mf.pex \
  --package middlefield_echo \
  --shebang '/usr/bin/env python3'
$ ./mf.pex echo --what hello 
hello
$ upload-to-internal-place mf.pex
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
\frametitle{Example plugin -- middlefield echo (setup.py)}
\begin{lstlisting}
<snip>
setuptools.setup(
entry_points={"gather":["gather=middlefield_echo"]},
<snip>
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
\frametitle{Example plugin -- middlefield echo (deps.py)}
\begin{lstlisting}
<snip>
@middlefield.COMMANDS.dependency()
def echo_printer(_deps, _maybe_deps):
    return print
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
\frametitle{Example plugin -- middlefield echo (command.py)}
\begin{lstlisting}
<snip>
@middlefield.COMMANDS.command(
parser=command('',
    what=option(type=typing.List[str],
                have_default=True)),
dependencies=['echo_printer'])
def echo(args, dependencies):
    dependencies['echo_printer'](*args['what'])
\end{lstlisting}
\end{frame}

\begin{frame}
\frametitle{What's next?}
\begin{itemize}
\item Write a plugin (internal or public)
\item Distribute internally
\item Talk to me zadka.moshe@gmail.com https://cobordism.com
\end{itemize}
\end{frame}

\end{document}
